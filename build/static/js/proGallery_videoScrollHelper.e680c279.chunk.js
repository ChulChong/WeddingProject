"use strict";(self.webpackChunkwedding=self.webpackChunkwedding||[]).push([[731],{96656:function(t,e,i){i.r(e),i.d(e,{default:function(){return l}});var r=i(82468),n=i(28091),o=i(70291);function a(t){var e=t.offset,i=t.scroll,r=t.itemStart;return{before:i-e-t.itemEnd,after:e+r-t.screenSize-i}}var l=function(t,e,i){var l=this;this.setPlayingItem=t,this.isItemSupported=e,this.getPlayTrigger=i,this.scrollBase=0,this.items=[],this.currentPlayingIdx=-1,this.currentItemCount=0,this.lastVideoPlayed=-1,this.itemRatingMap=new Map,this.updateGalleryStructure=function(t){var e=t.galleryStructure,i=t.galleryWidth,r=t.scrollBase,n=t.options;l.galleryWidth=i,l.scrollBase=r,l.playTrigger=l.getPlayTrigger(n),l.videoLoop=n.behaviourParams_item_video_loop,l.scrollDirection=n.layoutParams_structure_scrollDirection,l.currentItemCount=e.galleryItems.length,l.items=[],e.galleryItems.forEach((function(t){l.isItemSupported(t)&&(l.itemRatingMap.has(t.id)||l.itemRatingMap.set(t.id,t.idx),l.items.push(t))}))},this.handleEvent=function(t){var e=t.eventName,i=t.eventData;switch(e){case r.Z.events.ITEM_ACTION_TRIGGERED:l.itemClicked(i.idx);break;case r.Z.events.VIDEO_PAUSED:l.currentPlayingIdx===i.idx&&l.stop(i.idx);break;case r.Z.events.HOVER_SET:l.itemHovered(i);break;case r.Z.events.VIDEO_ENDED:l.videoEnded(i.idx);break;case r.Z.events.VIDEO_PLAYED:l.videoPlayed(i.idx);break;case r.Z.events.VIDEO_ERROR:l.videoErrorReported()}},this.shouldTriggerAction=function(t,e){return void 0===e&&(e="HOVER"),l.findItem(t)&&l.shouldTrigger(e)},this.itemHovered=function(t){l.shouldTriggerAction(t,"HOVER")&&l.play(t)},this.itemClicked=function(t){l.shouldTriggerAction(t,"CLICK")&&(l.currentPlayingIdx===t?l.stop(t):l.play(t))},this.onScroll=function(t){var e=t.top,i=t.left;l.top=e>=0?e:l.top,l.left=i>=0?i:l.left,-1===l.currentPlayingIdx||l.isCurrentItemStillVisible({top:l.top,left:l.left})||l.stop(l.currentPlayingIdx),l.autoPlayNextItemByRating({top:l.top,left:l.left})},this.videoEnded=function(t){l.stop(t);var e={top:l.top,left:l.left};l.autoPlayNextItemByRating(e)},this.videoPlayed=function(t){l.currentPlayingIdx===t||l.findItem(t)||l.play(t),l.lastVideoPlayed=t},this.videoErrorReported=function(){l.stop()},this.initializePlayState=function(){l.autoPlayNextItemByRating({top:l.top,left:l.left})},this.autoPlayNextItemByRating=function(t){var e=t.top,i=t.left;if(l.shouldTrigger("AUTO")){var r={idx:-1,rating:1/0},n={idx:-1,rating:1/0};if(l.items.some((function(t){if(l.isVisible(t,{top:e,left:i})){var o=l.itemRatingMap.get(t.id);return o<=n.rating?(r.idx=n.idx,r.rating=n.rating,n.idx=t.idx,n.rating=o):o<=r.rating&&(r.idx=t.idx,r.rating=o),!1}return n.idx>=0})),n.idx>=0)if(l.videoLoop||n.idx!==l.lastVideoPlayed)l.play(n.idx);else{if(!(r.idx>=0))return;l.play(r.idx)}else l.lastVideoPlayed=-2}},this.play=function(t){l.setPlayingIdx(t)},this.stop=function(t){void 0===t&&(t=l.currentPlayingIdx);var e=l.findItem(t);if(e){var i=l.itemRatingMap.get(e.id)+l.currentItemCount;l.itemRatingMap.set(e.id,i)}l.setPlayingIdx(-1)},this.onPlayingIdxChange=function(){l.setPlayingItem(l.currentPlayingIdx)},this.setPlayingIdx=function(t){l.currentPlayingIdx!==t&&(l.currentPlayingIdx=t,l.onPlayingIdxChange())},this.isCurrentItemStillVisible=function(t){var e=t.top,i=t.left,r=l.findItem(l.currentPlayingIdx);return!!r&&l.isVisible(r,{top:e,left:i})},this.isVisible=function(t,e){var i,s=e.top,d=e.left,f={offsetTop:l.scrollBase||0,scrollY:s,scrollLeft:d},c=(t.offset.top-t.offset.bottom)/2,u=(t.offset.left-t.offset.right)/2,g=function(t){var e=t.target,i=t.scrollBase,r=t.top,n=t.bottom,o=t.screenHeight,l=t.padding,s=a({offset:i||0,scroll:e.scrollY,itemStart:r,itemEnd:n,screenSize:o});return s.before<l&&s.after<l}({target:f,scrollBase:l.scrollBase,top:t.offset.top,bottom:t.offset.top+t.style.height,screenHeight:n.Z&&n.Z.innerHeight,padding:c});return i=l.scrollDirection===r.Z[o.Z.layoutParams.structure.scrollDirection].VERTICAL||function(t){var e=t.target,i=t.left,r=t.right,n=t.screenWidth,o=t.padding,l=a({offset:0,scroll:e.scrollLeft,itemStart:i,itemEnd:r,screenSize:n});return l.before<o&&l.after<o}({target:f,left:t.offset.left,right:t.offset.left+t.style.width,screenWidth:l.galleryWidth||n.Z&&n.Z.innerWidth,padding:u}),g&&i},this.shouldTrigger=function(t){return l.playTrigger===t},this.findItem=function(t){return l.items.find((function(e){return e.idx===t}))}}}}]);
//# sourceMappingURL=proGallery_videoScrollHelper.e680c279.chunk.js.map