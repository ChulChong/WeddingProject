"use strict";(self.webpackChunkwedding=self.webpackChunkwedding||[]).push([[367],{7633:(e,t,i)=>{i.r(t),i.d(t,{default:()=>h});var s=i(5043),o=i(9453),a=i(5126),r=i(1713),d=i(4644),l=i(6537);function p(e,t){const i="calc(100% + 1px)";return e?{height:t?i:"auto",width:t?"auto":i,position:"absolute",margin:"auto",minHeight:"100%",minWidth:"100%",left:"-100%",right:"-100%",top:"-100%",bottom:"-100%"}:{width:t?i:"auto",height:t?"100%":i}}class n extends s.Component{constructor(e){super(e),this.pause=this.pause.bind(this),this.play=this.play.bind(this),this.playVideoIfNeeded=this.playVideoIfNeeded.bind(this),this.state={playedOnce:!1,loadVideo:e.loadVideo||e.shouldPlay,isPlaying:!1,shouldPlay:e.shouldPlay,reactPlayerLoaded:!1,vimeoPlayerLoaded:!1,hlsPlayerLoaded:!1}}componentDidMount(){this.dynamiclyImportVideoPlayers()}dynamiclyImportVideoPlayers(){o.A&&o.A.ReactPlayer||i.e(749).then(i.bind(i,5331)).then((e=>{o.A.ReactPlayer=e.default,this.setState({reactPlayerLoaded:!0}),this.playVideoIfNeeded()})),o.A&&o.A.Vimeo||!this.props.videoUrl||!this.props.videoUrl.includes("vimeo.com")||i.e(896).then(i.bind(i,9144)).then((e=>{o.A.Vimeo={Player:e.default},this.setState({vimeoPlayerLoaded:!0}),this.playVideoIfNeeded()})),o.A&&o.A.Hls||!this.isHLSVideo()||i.e(51).then(i.bind(i,9788)).then((e=>{o.A.Hls=e.default,this.setState({hlsPlayerLoaded:!0}),this.playVideoIfNeeded()}))}isHLSVideo(){return this.props.videoUrl&&(this.props.videoUrl.includes("/hls")||this.props.videoUrl.includes(".m3u8"))}shouldUseHlsPlayer(){return this.isHLSVideo()&&!a.A.isiOS()}shouldForceVideoForHLS(){return this.isHLSVideo()&&a.A.isiOS()}UNSAFE_componentWillReceiveProps(e){(e.shouldPlay||e.firstUserInteractionExecuted)&&this.setState({loadVideo:!0}),e.shouldPlay&&this.setState({shouldPlay:!0}),this.playVideoIfNeeded(e)}componentDidUpdate(e){e.activeIndex!==this.props.activeIndex&&this.fixIFrameTabIndexIfNeeded(),"image"===e.type&&"video"===this.props.type&&this.dynamiclyImportVideoPlayers(),this.playVideoIfNeeded()}play(){this.props.playVideo(this.props.idx)}pause(){this.props.pauseVideo()}playVideoIfNeeded(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.props;try{const{shouldPlay:t}=e;t&&!this.isPlaying&&(this.videoElement=this.videoElement||o.A.document.querySelector(`#video-${this.props.id}-${this.props.galleryId} video`),this.videoElement&&(this.isPlaying=!0,this.videoElement.play(),a.A.isVerbose()&&console.log("[VIDEO] Playing video #"+this.props.idx,this.videoElement)))}catch(t){console.error("[VIDEO] Could not play video #"+this.props.idx,this.videoElement,t)}}createPlayerElement(){if(!o.A||!o.A.ReactPlayer||!this.state.loadVideo&&!this.props.playing)return null;const e=o.A.ReactPlayer,t=this.props.style.ratio>=this.props.cropRatio,i=this.props.options[r.A.layoutParams.crop.enable]&&this.props.options[r.A.layoutParams.crop.method]===d.A[r.A.layoutParams.crop.method].FILL,a=this.props.videoUrl?this.props.videoUrl:this.props.createUrl(d.A.urlSizes.RESIZED,d.A.urlTypes.VIDEO),n={controlsList:"nodownload",disablePictureInPicture:!0,muted:!this.props.options[r.A.behaviourParams.item.video.volume],preload:"metadata",style:p(i,t),type:"video/mp4"};return(0,l.g4)(this.props.options)&&(n.poster=this.props.createUrl(d.A.urlSizes.SCALED,d.A.urlTypes.HIGH_RES)),s.createElement(e,{playsinline:!0,className:"gallery-item-visible video gallery-item",id:`video-${this.props.id}-${this.props.galleryId}`,width:"100%",height:"100%",url:a,alt:"string"===typeof this.props.alt?this.props.alt:"untitled video",loop:!!this.props.options[r.A.behaviourParams.item.video.loop],ref:e=>this.video=e,volume:this.props.options[r.A.behaviourParams.item.video.volume]?.8:0,playing:this.state.shouldPlay,onEnded:()=>{this.setState({isPlaying:!1}),this.props.actions.eventsListener(d.A.events.VIDEO_ENDED,this.props)},onPause:()=>{this.setState({isPlaying:!1})},onError:e=>{this.props.actions.eventsListener(d.A.events.VIDEO_ERROR,Object.assign(Object.assign({},this.props),{videoError:e}))},playbackRate:Number(this.props.options[r.A.behaviourParams.item.video.speed])||1,onStart:()=>{this.state.playedOnce||this.setState({playedOnce:!0})},onPlay:()=>{this.props.actions.eventsListener(d.A.events.VIDEO_PLAYED,this.props),this.setState({isPlaying:!0})},onReady:()=>{this.playVideoIfNeeded(),this.fixIFrameTabIndexIfNeeded(),this.props.actions.setItemLoaded(),this.setState({ready:!0})},onProgress:()=>{this.props.shouldPlay||this.setState({shouldPlay:!1})},controls:this.props.options[r.A.behaviourParams.item.video.enableControls],config:{file:{attributes:n,forceHLS:this.shouldUseHlsPlayer(),forceVideo:this.shouldForceVideoForHLS()}},key:"video-"+this.props.id})}fixIFrameTabIndexIfNeeded(){if(this.props.isExternalVideo){const e=o.A.document&&o.A.document.getElementById(`video-${this.props.id}-${this.props.galleryId}`),t=e&&e.getElementsByTagName("iframe"),i=t&&t[0];i&&(this.props.activeIndex===this.props.idx?i.setAttribute("tabIndex","0"):i.setAttribute("tabIndex","-1"))}}getVideoContainerStyles(){const e=Object.assign({},this.props.imageDimensions);return a.A.deviceHasMemoryIssues()||this.state.ready||!(0,l.g4)(this.props.options)||(e.backgroundImage=`url(${this.props.createUrl(d.A.urlSizes.RESIZED,d.A.urlTypes.HIGH_RES)})`),e}render(){const{thumbnail:e,hover:t}=this.props;let i=["gallery-item-content","gallery-item-visible","gallery-item-preloaded","gallery-item-video","gallery-item","video-item"];a.A.isiPhone()&&i.push("ios"),this.state.isPlaying&&i.push("playing"),this.state.playedOnce&&this.state.ready&&i.push("playedOnce"),this.props.isCurrentHover?i.push("item-content-hover"):i.push("item-content-regular");const o=s.createElement("div",{className:i.join(" "),"data-hook":"video_container-video-player-element",key:"video_container-"+this.props.id,style:this.getVideoContainerStyles()},this.createPlayerElement(),this.state.isPlaying?null:this.props.videoPlayButton);return s.createElement("div",{key:"video-and-hover-container"+this.props.idx},o,(0,l.g4)(this.props.options)&&e,t)}}const h=n}}]);
//# sourceMappingURL=proGallery_videoItem.99d059cd.chunk.js.map