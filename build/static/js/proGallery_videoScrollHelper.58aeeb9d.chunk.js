"use strict";(self.webpackChunkwedding=self.webpackChunkwedding||[]).push([[313],{4640:(t,i,e)=>{e.r(i),e.d(i,{default:()=>o});var s=e(4644),r=e(9453),l=e(1713);function n(t){let{offset:i,scroll:e,itemStart:s,itemEnd:r,screenSize:l}=t;return{before:e-i-r,after:i+s-l-e}}const o=class{constructor(t,i,e){var o=this;this.setPlayingItem=t,this.isItemSupported=i,this.getPlayTrigger=e,this.scrollBase=0,this.items=[],this.currentPlayingIdx=-1,this.currentItemCount=0,this.lastVideoPlayed=-1,this.itemRatingMap=new Map,this.updateGalleryStructure=t=>{let{galleryStructure:i,galleryWidth:e,scrollBase:s,options:r}=t;this.galleryWidth=e,this.scrollBase=s,this.playTrigger=this.getPlayTrigger(r),this.videoLoop=r.behaviourParams_item_video_loop,this.scrollDirection=r.layoutParams_structure_scrollDirection,this.currentItemCount=i.galleryItems.length,this.items=[],i.galleryItems.forEach((t=>{this.isItemSupported(t)&&(this.itemRatingMap.has(t.id)||this.itemRatingMap.set(t.id,t.idx),this.items.push(t))}))},this.handleEvent=t=>{let{eventName:i,eventData:e}=t;switch(i){case s.A.events.ITEM_ACTION_TRIGGERED:this.itemClicked(e.idx);break;case s.A.events.VIDEO_PAUSED:this.currentPlayingIdx===e.idx&&this.stop(e.idx);break;case s.A.events.HOVER_SET:this.itemHovered(e);break;case s.A.events.VIDEO_ENDED:this.videoEnded(e.idx);break;case s.A.events.VIDEO_PLAYED:this.videoPlayed(e.idx);break;case s.A.events.VIDEO_ERROR:this.videoErrorReported()}},this.shouldTriggerAction=function(t){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"HOVER";return o.findItem(t)&&o.shouldTrigger(i)},this.itemHovered=t=>{this.shouldTriggerAction(t,"HOVER")&&this.play(t)},this.itemClicked=t=>{this.shouldTriggerAction(t,"CLICK")&&(this.currentPlayingIdx===t?this.stop(t):this.play(t))},this.onScroll=t=>{let{top:i,left:e}=t;this.top=i>=0?i:this.top,this.left=e>=0?e:this.left,-1===this.currentPlayingIdx||this.isCurrentItemStillVisible({top:this.top,left:this.left})||this.stop(this.currentPlayingIdx),this.autoPlayNextItemByRating({top:this.top,left:this.left})},this.videoEnded=t=>{this.stop(t);const i={top:this.top,left:this.left};this.autoPlayNextItemByRating(i)},this.videoPlayed=t=>{this.currentPlayingIdx===t||this.findItem(t)||this.play(t),this.lastVideoPlayed=t},this.videoErrorReported=()=>{this.stop()},this.initializePlayState=()=>{this.autoPlayNextItemByRating({top:this.top,left:this.left})},this.autoPlayNextItemByRating=t=>{let{top:i,left:e}=t;if(!this.shouldTrigger("AUTO"))return;const s={idx:-1,rating:1/0},r={idx:-1,rating:1/0};if(this.items.some((t=>{if(this.isVisible(t,{top:i,left:e})){const i=this.itemRatingMap.get(t.id);return i<=r.rating?(s.idx=r.idx,s.rating=r.rating,r.idx=t.idx,r.rating=i):i<=s.rating&&(s.idx=t.idx,s.rating=i),!1}return r.idx>=0})),r.idx>=0)if(this.videoLoop||r.idx!==this.lastVideoPlayed)this.play(r.idx);else{if(!(s.idx>=0))return;this.play(s.idx)}else this.lastVideoPlayed=-2},this.play=t=>{this.setPlayingIdx(t)},this.stop=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:o.currentPlayingIdx;const i=o.findItem(t);if(i){const t=o.itemRatingMap.get(i.id)+o.currentItemCount;o.itemRatingMap.set(i.id,t)}o.setPlayingIdx(-1)},this.onPlayingIdxChange=()=>{this.setPlayingItem(this.currentPlayingIdx)},this.setPlayingIdx=t=>{this.currentPlayingIdx!==t&&(this.currentPlayingIdx=t,this.onPlayingIdxChange())},this.isCurrentItemStillVisible=t=>{let{top:i,left:e}=t;const s=this.findItem(this.currentPlayingIdx);return!!s&&this.isVisible(s,{top:i,left:e})},this.isVisible=(t,i)=>{let{top:e,left:o}=i;const h={offsetTop:this.scrollBase||0,scrollY:e,scrollLeft:o},a=(t.offset.top-t.offset.bottom)/2,d=(t.offset.left-t.offset.right)/2,g=function(t){let{target:i,scrollBase:e,top:s,bottom:r,screenHeight:l,padding:o}=t;const h=n({offset:e||0,scroll:i.scrollY,itemStart:s,itemEnd:r,screenSize:l});return h.before<o&&h.after<o}({target:h,scrollBase:this.scrollBase,top:t.offset.top,bottom:t.offset.top+t.style.height,screenHeight:r.A&&r.A.innerHeight,padding:a});let c;return c=this.scrollDirection===s.A[l.A.layoutParams.structure.scrollDirection].VERTICAL||function(t){let{target:i,left:e,right:s,screenWidth:r,padding:l}=t;const o=n({offset:0,scroll:i.scrollLeft,itemStart:e,itemEnd:s,screenSize:r});return o.before<l&&o.after<l}({target:h,left:t.offset.left,right:t.offset.left+t.style.width,screenWidth:this.galleryWidth||r.A&&r.A.innerWidth,padding:d}),g&&c},this.shouldTrigger=t=>this.playTrigger===t,this.findItem=t=>this.items.find((i=>i.idx===t))}}}}]);
//# sourceMappingURL=proGallery_videoScrollHelper.58aeeb9d.chunk.js.map